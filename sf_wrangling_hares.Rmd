---
title: "data_wrangling"
author: "Sandra Fogg"
date: "1/26/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, warning = FALSE, message = FALSE, include = FALSE}
# Load Required Packages
library(tidyverse)
library(janitor)
library(kableExtra)
library(knitr)
library(ggplot2)

```
A useful descriptive introductory summary (3 - 4 sentences) of what’s contained in the project
mage(s), with captions and necessary citation(s), of showshoe hares and/or a map of the study area
All of your organized and well-annotated code (with warnings/messages hidden) used to create at least:



![](/Users/sandra/Documents/MESM Year 1/GitHub/snowshoe_hares/snowhare.jpg)
<br>
Study Area
<br>
The study area is located 
<br>

![](/Users/sandra/Documents/MESM Year 1/GitHub/snowshoe_hares/map1.png)
<br>
<br>
The specific study area is located
<br>

![](/Users/sandra/Documents/MESM Year 1/GitHub/snowshoe_hares/map2.png)
<br>

Clean the Data
```{r, warning = FALSE, message = FALSE}
# Read in Data
snowshoe_df <- read_csv("showshoe_lter.csv")

# Select Sex, Weight, Hindfoot Ratio, and Grid 
# Filter Information from Grid "bonmat", as Adequate Metadata for the Site is Unavailable
# Remove Rows Containing Questionable Sex
# Convert Grid and Sex Data to Lowercase
# Remove NAs from the Dataframe
snowshoe_clean_df <- snowshoe_df %>% 
  select(grid, sex, weight, age) %>% 
  filter(grid != "bonmat",
         sex != "?",
         sex != "M?",
         sex != "F?",
         sex != "m?",
         sex != "f?",
         sex != "pf",
         age == "A") %>%
    mutate(grid_l = str_to_lower(grid),
           sex_l = str_to_upper(sex)) %>% 
  select(-grid,
        -sex,
        -grid_l) %>% 
  na.omit()

```

Summarize the Data
```{r, warning = FALSE, message = FALSE}
# Summarize the 

# Create a Summary Table of Mean Weight and Hind Foot Ratio for Each Sex
mean_table <- snowshoe_clean_df %>% 
  group_by(sex_l) %>% 
  summarise(mean_wt = round(mean(weight), 0),
            max_wt = round(max(weight), 1),
            min_wt  = round(min(weight), 1),
            med_wt = round(median(weight), 1))

names(mean_table) <- c("Sex", "Mean (g)", "Maximum (g)", "Minimum (g)", "Median (g)") 

summary_table <- kable(mean_table) %>% 
  kable_styling(bootstrap_options = "striped", 
                full_width = FALSE) %>% 
  add_header_above(c("Adult Snowshoe Hare Weights in the Bonanza Creek Experimental Forest" = 5))

summary_table
```

Visualize the Data
```{r, warning = FALSE, message = FALSE}
# Create a Graph of the Data
labels <- c(F = "Female", M = "Male")



snowshoe_graph <- ggplot(snowshoe_clean_df, aes(x = snowshoe_clean_df$weight, color = snowshoe_clean_df$sex_l, 
                                                fill = snowshoe_clean_df$sex_l)) +
  geom_histogram(binwidth = 100, alpha = 0.5) + 
  facet_wrap(~sex_l, labeller=labeller(sex_l = labels)) +
  scale_x_continuous(breaks = seq(500, 2500, by = 250)) +
  theme_classic() +
  theme(legend.position = "none") +
  labs(title="Adult Snowshoe Hare Weight Distribution (1999-2012)",x=" Weight (g)", y = "Number of Individuals", legend.title= "Sex")

snowshoe_graph
                         
```
A useful descriptive introductory summary (3 - 4 sentences) of what’s contained in the project
mage(s), with captions and necessary citation(s), of showshoe hares and/or a map of the study area
All of your organized and well-annotated code (with warnings/messages hidden) used to create at least:

One finalized graph about the Bonanza Creek snowshoe hare population (you pick which variables, how you want to wrangle it beforehand, and which type of visual to create - but make sure it is beautifully finalized)
One finalized HTML table (probably created using kable & kableExtra) containing summary statistics about the snowshoe hares (again, you pick which variables, and how you want to group/summarize them)

Make sure that both your figure and table appear in your final knitted document, each with a useful caption. Include text associated with each to help the audience understand and interpret the results. 

